// Cosa fa			:			Genera l'md5 delle righe righe della tabella outputstrings dove cEscludi == 'x'
//									e le salva nella tabella esclusioni
function md5Esclusioni()
	local d,q,lc_bRet,q1
	
	lc_bRet = False
	
	d = new database()
	d.databasename = "TranslateDB"
	d.loginString = "SYSDBA/masterkey"
	d.active = True
	
	q = new query()
	q.database = d
	q.sql = "SELECT id,sRiga FROM OUTPUTSTRINGS WHERE CESCLUDI = 'x'"
	q.active = True
	
	q1 = new query()
	q1.database = d
	q1.sql = "SELECT * FROM ESCLUSIONI"
	q1.active = True
	
	do while not(q.rowset.endOfSet)
//		try
			q1.beginAppend()
			
			q1.rowset.fields['IDR'].Value = q.rowset.fileds['id'].Value
			q1.rowset.fields['sRiga'].Value = substr(q.rowset.fileds['sRiga'].Value,1,1)
			
			q.rowset.next()
			q1.save()
//		catch (Exception e)
//			return lc_bRet
		endtry
	enddo
	
	lc_bRet = True
	
	q1.active = False
	release object q1
	q1 = NULL
	
	q.active = False
	release object q
	q = NULL
	
	d.active = False
	release object d
	d = NULL
	
	return lc_bRet